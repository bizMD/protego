// Generated by CoffeeScript 1.10.0
(function() {
  var $, animate, beepCircle, createBasicMap, d3, moveLine, oboe, redAreas, render, resolve;

  require('sugar');

  $ = require('jquery');

  d3 = require('d3');

  oboe = require('oboe');

  resolve = require('path').resolve;

  redAreas = require('./mockData');

  beepCircle = require('./beepCircle');

  moveLine = require('./moveLine');

  render = require('./render');

  animate = function(projection, duration) {
    var data;
    console.log('Triggering animations');
    data = redAreas();
    (function() {
      return data = redAreas();
    }).every(30000);
    return (function() {
      return beepCircle(data, projection, duration);
    }).every(duration);
  };

  createBasicMap = function(projection) {
    var height, width;
    console.log('Rendering page...');
    width = $('#mapContainer').width();
    height = $('#mapContainer').height();
    projection.scale(100 * width / 640).translate([width / 2, height / 2]);
    return oboe('/data/world').done(function(world) {
      return render('mapContainer', world, projection);
    });
  };

  $(function() {
    var duration, projection;
    if ($('#basicMap').length) {
      projection = d3.geo.equirectangular();
      createBasicMap(projection);
      window.onresize = function() {
        return createBasicMap(projection);
      };
      duration = 10000;
      return animate(projection, duration);
    }
  });

}).call(this);
